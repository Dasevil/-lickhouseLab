Уникальных категорий: 5261=== АНАЛИЗ ИСХОДНЫХ ДАННЫХ ===
1. Уникальных категорий: 5261
2. Максимальная глубина вложенности категорий: 8
3. Топ-5 категорий по количеству товаров:
   Строительство и ремонт\Инструменты для ремонта и строительства\Пневмоинструменты\Пневмогайковерты: 300 товаров
   Строительство и ремонт\Инструменты для ремонта и строительства\Пневмоинструменты\Прочие пневмоинструменты: 300 товаров
   Строительство и ремонт\Инструменты для ремонта и строительства\Пневмоинструменты\Аксессуары и оснастка для пневмоинструментов: 300 товаров
   Строительство и ремонт\Инструменты для ремонта и строительства\Пневмоинструменты\Шланги воздушные для компрессора: 300 товаров
   Строительство и ремонт\Инструменты для ремонта и строительства\Малярные и отделочные инструменты\Шпатели: 300 товаров
4. Количество товаров с одинаковыми Offer_ID у разных партнеров: 0
5. Уникальных типов товаров (Offer_Type): 12379=== АНАЛИТИЧЕСКАЯ СПРАВКА ===
Структура данных представляет собой плоскую таблицу с информацией о товарах интернет-магазина.
Каждая строка соответствует одному товару и содержит информацию о партнере, кате
егории, идентификаторе товара и его типе.
Категории представлены в виде иерархического пути с разделителем '\\', что позво
оляет определить уровень вложенности.
В данных присутствуют 5261 уникальных категорий с максимальной глубиной вложенно
ости 8 уровней.
Наиболее насыщенные категории содержат сотни товаров, что указывает на разнообра
азие ассортимента.
Обнаружено 0 товаров с одинаковыми Offer_ID у разных партнеров, что может указыв
вать на дублирование или партнерскую программу.
Присутствует 12379 уникальных типов товаров, что говорит о широкой продуктовой л
линейке.

=== ОБОСНОВАНИЕ ВЫБОРА СХЕМЫ ===
Выбор создания двух коллекций (categories и products) вместо одной обусловлен сл
ледующими причинами:
1. Нормализация данных: информация о категории (название, путь, уровень) дублиру
уется для каждого товара в категории.
   Выделение категорий в отдельную коллекцию позволяет избежать избыточного хран
нения одинаковой информации.
2. Независимость обновлений: метаданные категории (например, общее количество то
оваров) могут обновляться независимо от товаров.
   Это позволяет эффективно поддерживать актуальность информации о категориях.  
3. Гибкость запросов: отдельная коллекция категорий позволяет выполнять иерархич
ческие запросы (поиск подкатегорий,
   навигация по уровням) без необходимости сканирования всей коллекции товаров. 
4. Эффективность индексации: индексы для коллекции категорий могут быть оптимизи
ированы под иерархические запросы,
   а индексы для коллекции товаров - под поисковые и аналитические запросы.     

=== ПРЕИМУЩЕСТВА ДЕНОРМАЛИЗАЦИИ ===
Денормализация данных в данном кейсе имеет следующие преимущества:
1. Производительность запросов: в коллекции товаров информация о категории дубли
ируется (вложенный документ category),
   что позволяет получать полную информацию о товаре и его категории одним запро
осом без JOIN операций.
2. Упрощение запросов: клиентское приложение может отображать информацию о катег
гории (название, полный путь)
   без необходимости выполнять дополнительные запросы к коллекции категорий.    
3. Снижение нагрузки на базу данных: отсутствие необходимости в соединениях умен
ньшает нагрузку на сервер,
   особенно при высокой частоте запросов к товарам.
4. Масштабируемость: документо-ориентированная модель с денормализацией лучше ма
асштабируется по горизонтали,
   так как каждый документ содержит всю необходимую информацию для типовых опера
аций.

=== СОЗДАНИЕ КОЛЛЕКЦИИ КАТЕГОРИЙ ===
C:\Users\User\PycharmProjects\ClickhouseLab\practice_mongodb\load_data.py:145: D
DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for re
emoval in a future version. Use timezone-aware objects to represent datetimes in 
 UTC: datetime.datetime.now(datetime.UTC).
  "last_updated": datetime.utcnow()
Вставлено 5261 документов в коллекцию categories

=== СТАТИСТИКА ПО УРОВНЯМ ВЛОЖЕННОСТИ КАТЕГОРИЙ ===
Уровень 1: 5261 категорий